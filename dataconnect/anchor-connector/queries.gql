# User queries
query GetUser($id: String!) {
  user(id: $id) {
    id
    email
    name
    avatar
    phone
    createdAt
    updatedAt
  }
}

query GetUserByEmail($email: String!) {
  users(where: { email: { eq: $email } }) {
    id
    email
    name
    avatar
    phone
    createdAt
    updatedAt
  }
}

# Child queries
query GetChildrenByOwner($ownerId: String!) {
  children(where: {
    ownerId: { eq: $ownerId },
    deletedAt: { eq: null }
  }) {
    id
    name
    dateOfBirth
    diagnosis
    allergies
    bloodType
    currentWeight
    currentHeight
    headCircumference
    ngTubePlacement
    keyMedicalNotes
    emergencyContact
    hospitalId
    primaryPhysician
    createdAt
    updatedAt
    owner {
      id
      name
      email
    }
  }
}

query GetChildById($id: String!) {
  child(id: $id) {
    id
    name
    dateOfBirth
    diagnosis
    allergies
    bloodType
    currentWeight
    currentHeight
    headCircumference
    ngTubePlacement
    keyMedicalNotes
    emergencyContact
    hospitalId
    primaryPhysician
    createdAt
    updatedAt
    owner {
      id
      name
      email
    }
  }
}

# Entry queries
query GetEntriesByChild($childId: String!, $limit: Int = 50) {
  entries(
    where: {
      childId: { eq: $childId },
      deletedAt: { eq: null }
    },
    orderBy: { createdAt: DESC },
    limit: $limit
  ) {
    id
    title
    content
    tags
    priority
    assignedToId
    assignedById
    completedAt
    completedById
    isPrivate
    isPinned
    createdAt
    updatedAt
    user {
      id
      name
      email
    }
    child {
      id
      name
    }
    assignedTo {
      id
      name
      email
    }
    assignedBy {
      id
      name
      email
    }
    completedBy {
      id
      name
      email
    }
  }
}

query GetEntriesByTags($childId: String!, $tags: [String!]!) {
  entries(
    where: {
      childId: { eq: $childId },
      tags: { arrayContains: $tags },
      deletedAt: { eq: null }
    },
    orderBy: { createdAt: DESC }
  ) {
    id
    title
    content
    tags
    priority
    assignedToId
    assignedById
    completedAt
    completedById
    isPrivate
    isPinned
    createdAt
    updatedAt
    user {
      id
      name
      email
    }
    assignedTo {
      id
      name
      email
    }
    assignedBy {
      id
      name
      email
    }
  }
}

# Medication queries
query GetMedicationsByChild($childId: String!) {
  medications(
    where: {
      childId: { eq: $childId },
      deletedAt: { eq: null }
    },
    orderBy: { createdAt: DESC }
  ) {
    id
    name
    dosage
    frequency
    route
    prescribedBy
    startDate
    endDate
    instructions
    sideEffects
    createdAt
    updatedAt
    child {
      id
      name
    }
  }
}

# Notification queries
query GetNotificationsByUser($userId: String!, $limit: Int = 20) {
  notifications(
    where: {
      userId: { eq: $userId },
      deletedAt: { eq: null }
    },
    orderBy: { createdAt: DESC },
    limit: $limit
  ) {
    id
    title
    message
    type
    priority
    isRead
    relatedItemId
    createdAt
    updatedAt
    user {
      id
      name
      email
    }
    child {
      id
      name
    }
  }
}

query GetUnreadNotifications($userId: String!) {
  notifications(
    where: {
      userId: { eq: $userId },
      isRead: { eq: false },
      deletedAt: { eq: null }
    },
    orderBy: { createdAt: DESC }
  ) {
    id
    title
    message
    type
    priority
    isRead
    relatedItemId
    createdAt
    updatedAt
    user {
      id
      name
      email
    }
    child {
      id
      name
    }
  }
}

# Collaboration queries
query GetCollaborationsByChild($childId: String!) {
  collaborations(
    where: {
      childId: { eq: $childId },
      deletedAt: { eq: null }
    }
  ) {
    id
    userId
    childId
    role
    canViewMedical
    canEditMedical
    canViewNotes
    canEditNotes
    canViewCalendar
    canEditCalendar
    canViewTodos
    canEditTodos
    canViewMessages
    canSendMessages
    canInviteOthers
    createdAt
    updatedAt
    user {
      id
      name
      email
    }
    child {
      id
      name
    }
  }
}

query GetCollaborationsByUser($userId: String!) {
  collaborations(
    where: {
      userId: { eq: $userId },
      deletedAt: { eq: null }
    }
  ) {
    id
    userId
    childId
    role
    canViewMedical
    canEditMedical
    canViewNotes
    canEditNotes
    canViewCalendar
    canEditCalendar
    canViewTodos
    canEditTodos
    canViewMessages
    canSendMessages
    canInviteOthers
    createdAt
    updatedAt
    user {
      id
      name
      email
    }
    child {
      id
      name
    }
  }
}

# Message queries
query GetMessagesByChild($childId: String!) {
  messages(where: {
    childId: { eq: $childId },
    deletedAt: { eq: null }
  }, orderBy: { createdAt: DESC }) {
    id
    content
    isEdited
    editedAt
    createdAt
    updatedAt
    replyToId
    author {
      id
      name
      email
      avatar
    }
    child {
      id
      name
    }
    attachments {
      id
      fileName
      originalName
      mimeType
      size
      url
      thumbnailUrl
      createdAt
    }
    mentions {
      id
      startIndex
      endIndex
      user {
        id
        name
        email
        avatar
      }
    }
    links {
      id
      entityType
      entityId
      linkText
      startIndex
      endIndex
    }
    replies {
      id
      content
      isEdited
      editedAt
      createdAt
      author {
        id
        name
        email
        avatar
      }
      attachments {
        id
        fileName
        originalName
        mimeType
        size
        url
        thumbnailUrl
        createdAt
      }
      mentions {
        id
        startIndex
        endIndex
        user {
          id
          name
          email
          avatar
        }
      }
      links {
        id
        entityType
        entityId
        linkText
        startIndex
        endIndex
      }
    }
  }
}

query GetMessage($id: String!) {
  message(id: $id) {
    id
    content
    isEdited
    editedAt
    createdAt
    updatedAt
    replyToId
    author {
      id
      name
      email
      avatar
    }
    child {
      id
      name
    }
    attachments {
      id
      fileName
      originalName
      mimeType
      size
      url
      thumbnailUrl
      createdAt
    }
    mentions {
      id
      startIndex
      endIndex
      user {
        id
        name
        email
        avatar
      }
    }
    links {
      id
      entityType
      entityId
      linkText
      startIndex
      endIndex
    }
    replies {
      id
      content
      isEdited
      editedAt
      createdAt
      author {
        id
        name
        email
        avatar
      }
      attachments {
        id
        fileName
        originalName
        mimeType
        size
        url
        thumbnailUrl
        createdAt
      }
      mentions {
        id
        startIndex
        endIndex
        user {
          id
          name
          email
          avatar
        }
      }
      links {
        id
        entityType
        entityId
        linkText
        startIndex
        endIndex
      }
    }
  }
}

# Helper queries for entity linking
query GetLinkableEntries($childId: String!) {
  entries(where: {
    childId: { eq: $childId },
    deletedAt: { eq: null }
  }, orderBy: { createdAt: DESC }) {
    id
    title
    content
    priority
    createdAt
    user {
      id
      name
    }
  }
}

query GetLinkableMedications($childId: String!) {
  medications(where: {
    childId: { eq: $childId },
    deletedAt: { eq: null }
  }, orderBy: { createdAt: DESC }) {
    id
    name
    dosage
    frequency
    startDate
    endDate
    createdAt
  }
}

query GetLinkableReminders($childId: String!) {
  reminders(where: {
    childId: { eq: $childId },
    deletedAt: { eq: null }
  }, orderBy: { dueDate: ASC }) {
    id
    title
    description
    dueDate
    reminderType
    createdAt
  }
}

query GetLinkableContacts($childId: String!) {
  contacts(where: {
    childId: { eq: $childId },
    deletedAt: { eq: null }
  }, orderBy: { name: ASC }) {
    id
    name
    relationship
    phone
    email
    isEmergencyContact
    isPrimaryContact
    createdAt
  }
}

query GetLinkableMedicalData($childId: String!) {
  medicalMeasurements(where: {
    childId: { eq: $childId },
    deletedAt: { eq: null }
  }, orderBy: { measuredAt: DESC }) {
    id
    type
    value
    unit
    notes
    measuredAt
    createdAt
  }
}

# Helper query for user mentions
query GetCollaboratorsByChild($childId: String!) {
  collaborations(where: {
    childId: { eq: $childId },
    deletedAt: { eq: null }
  }) {
    id
    role
    user {
      id
      name
      email
      avatar
    }
  }
}
